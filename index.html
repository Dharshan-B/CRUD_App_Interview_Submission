<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CRUD App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
  <h1 class="text-center mb-4">CRUD App with Minimalistic design</h1>

  <!-- Add Item Form -->
  <div class="card p-3 mb-4">
    <h4>Add Item</h4>
    <div class="row g-2">
      <div class="col-md-5">
        <input type="text" id="name" class="form-control" placeholder="Item Name">
      </div>
      <div class="col-md-3">
        <input type="number" id="quantity" class="form-control" placeholder="Quantity">
      </div>
      <div class="col-md-2">
        <button onclick="addItem()" class="btn btn-primary w-100">Add</button>
      </div>
    </div>
  </div>

  <!-- Items Table -->
  <table class="table table-bordered">
    <thead class="table-dark">
      <tr>
        <th>Name</th>
        <th>Quantity</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="list"></tbody>
  </table>
<footer class="text-center mt-5 mb-3">
  <hr>
  <p>Developed by <strong>Name: Dharshan B ; University: VIT University,Vellore</strong></p>
</footer>

  <script>
    const api = "/items";

    async function loadItems() {
      let res = await fetch(api);
      let data = await res.json();
      document.getElementById("list").innerHTML = data.map(item =>
        `<tr>
          <td><input type="text" value="${item.name}" id="name-${item._id}" class="form-control"></td>
          <td><input type="number" value="${item.quantity}" id="quantity-${item._id}" class="form-control"></td>
          <td>
            <button class="btn btn-success btn-sm" onclick="updateItem('${item._id}')">Update</button>
            <button class="btn btn-danger btn-sm" onclick="deleteItem('${item._id}')">Delete</button>
          </td>
        </tr>`
      ).join("");
    }

    async function addItem() {
      let name = document.getElementById("name").value;
      let quantity = document.getElementById("quantity").value;
      await fetch(api, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, quantity })
      });
      loadItems();
    }

    async function updateItem(id) {
      let name = document.getElementById(`name-${id}`).value;
      let quantity = document.getElementById(`quantity-${id}`).value;
      await fetch(`${api}/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, quantity })
      });
      loadItems();
    }

    async function deleteItem(id) {
      await fetch(`${api}/${id}`, { method: "DELETE" });
      loadItems();
    }

    loadItems();
  </script>
</body>
</html>
